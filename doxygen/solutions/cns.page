/*! \page cns Compressible Navier-Stokes

1d,2d,3d steady and transient manufactured solutions to the heat equation are available in MASA,
for both cartesian and axisymmetric cases. 

\section Mathematical Model
The conservation of mass, momentum, and total energy for a compressible steady viscous fluid may be written as:

\f[ 
\nabla \cdot \left( \rho u \right) = 0 
\f]

\f[
\nabla\cdot\left(\rho u u\right) = -\nabla p +  \nabla \cdot (\tau )
\f]

\f[
\nabla\cdot\left(\rho \bv{u} H\right) =-   \nabla\cdot(p  \mathbf{u}) -\nabla\cdot \mathbf{q} +  \nabla \cdot (\bv{\tau} \cdot \mathbf{u}).
\f]


The velocity in \f$ x \f$, \f$ y \f$ or \f$ z \f$-direction, respectively, and \f$ p \f$ is the pressure. 
The total enthalpy, \f$ H \f$, may be expressed in terms of the total energy per unit mass 
\f$ e_t \f$, density, and pressure:
\f$ H = e_t + \dfrac{p}{\rho} \f$

For a calorically perfect gas, the Navier\-Stokes equations are closed with two auxiliary relations for energy

\f[
e_t= e + u\cdot u 2
\f]

and with the ideal gas equation of state:
\f[
 
p=\rho RT.
\f]

The shear stress tensor is:
 \f{eqnarray}
  \tau_{xx}= \dfrac{2}{3}  \mu \left( 2 \diff{u}{x} - \diff{v}{y} -\diff{w}{z} \right) \\
  \tau_{xy}= \tau_{yx}=\mu \left( \diff{u}{y} + \diff{v}{x}\right) \\
  \tau_{yy}= \dfrac{2}{3}  \mu \left( 2 \diff{v}{y} - \diff{u}{x} -\diff{w}{z} \right) \\
  \tau_{yz}= \tau_{zy}=\mu \left( \diff{v}{z} + \diff{w}{y}\right) \\
  \tau_{zz}= \dfrac{2}{3}  \mu \left( 2 \diff{w}{z} - \diff{u}{x} -\diff{v}{y} \right) \\
  \tau_{xz}= \tau_{zx}=\mu \left( \diff{u}{z} + \diff{w}{x}\right)
 \f}

where \f$\mu\f$ is the absolute viscosity. The heat flux vector \f$\mathbf{q}=(q_x,q_y,q_z)\f$ is given by:
\f[
 q_x = - k \diff{T}{x}, \quad q_y = - k \diff{T}{y}, \quad \mbox{and} \quad q_z = - k \diff{T}{z}
 \f]
where \f$k\f$ is the thermal conductivity, which can be determined by choosing the Prandtl number:
\f$ k= \dfrac{\gamma R \mu}{ (\gamma-1) \text{Pr}}.\f$

\section Manufactured Solution

The Method of Manufactured Solutions (MMS) applied to Navier\-Stokes equations consists in modifying the following equations.

Roy(2002) proposed the general form of the primitive manufactured solution variables to be 
a function of sines and cosines:
\f{eqnarray} 
  \phi (x,y,z) = \phi_0+ \phi_x\, f_s \left(\frac{a_{\phi x} \pi x}{L} \right) +  \phi_y \\
  f_s\left(\frac{a_{\phi y} \pi y}{L}\right) + \phi_z \\
  f_s\left(\frac{a_{\phi z} \pi z}{L}\right)
\f}
where \f$\phi=\rho,u,v,w\f$ or \f$p\f$, and \f$f_s(\cdot)\f$ functions denote either sine or cosine function. Note that in this case, \f$\phi_x\f$, \f$\phi_y\f$  and \f$\phi_z\f$ are constants  and the subscripts do not denote differentiation.


Although \citet{Roy2002} provide the constants used in the manufactured solutions for the 2D supersonic and subsonic cases for Euler and Navier-Stokes equations, 
only the source term for the 2D mass conservation equation~() is presented.


Source terms  for mass conservation (\f$Q_\rho\f$), momentum (\f$Q_u\f$, \f$Q_v\f$ and \f$Q_w\f$)  and total energy (\f$Q_{e_t}\f$) equations are 
obtained by symbolic manipulations of compressible steady Navier--Stokes equations above using Maple~13~\citep{Maple} and are presented in the following sections for the one, two and three-dimensional cases.

\section 1D Steady Navier--Stokes equations

The manufactured analytical solutions () for each one of the variables in one-dimensional case of Navier--Stokes equations are:
\f{eqnarray}

\rho\left(x\right) =  \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho x} \pi x}{L}\right) \\
u\left(x\right) = u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right) \\
p\left(x\right) = p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right) \\

\f}


The MMS applied to Navier\-Stokes equations consists in modifying the 1D Navier\-Stokes equations 
by adding a source term to the right-hand side of each equation:
\f{eqnarray} 
\Diff{\rho u}{x} = Q_\rho \\
\Diff{\rho u^2 }{x}+ \Diff{p}{x} -\Diff{\tau_{xx}}{x}= Q_u \\
\Diff{\rho ue_t}{x}+ \Diff{pu}{x}+ \Diff{q_x}{x}-\Diff{u\tau_{xx}}{x} = Q_{e_t}
\f}

Source terms \f$Q_\rho\f$, \f$Q_u\f$ and \f$Q_{e_t}\f$ are obtained by symbolic manipulations of 
equations above using Maple and are presented in the following sections. The following auxiliary variables 
have been included in order to improve readability and computational efficiency:

\f{eqnarray}
\Rho_1 = \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho x} \pi x}{L}\right)\\
U_1   = u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\\
\PP_1  = p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right)\\
\f}

where the subscripts in \f$\Rho_1\f$, \f$\PP_1\f$ and \f$U_1\f$ refer to the 1D case.

\subsection 1D Mass Conservation

The mass conservation equation written as an operator is:
\f[
 \Lo= \Diff{\rho u}{x}.
\f]

Analytically differentiating: \f[
Q_\rho = \dfrac{a_{\rho x} \pi \rho_x U_1}{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) +\\
 \dfrac{a_{ux} \pi u_x \Rho_1}{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) 
\f]


\subsection 1D_Momentum

For the generation of the analytical source term \f$Q_u\f$ for the \f$x\f$-momentum equation, Equation  is written as an  operator \f$\Lo\f$:
\f[
 \Lo=\Diff{\rho u^2 }{x}+ \Diff{p}{x} -\Diff{\tau_{xx}}{x},
\f]
which, when operated in this equation:

\f[
Q_u=\dfrac{a_{\rho x} \pi \rho_x U_1^2}{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) + \\
-\dfrac{ a_{px} \pi p_x}{L}\sin\left(\dfrac{a_{px} \pi x}{L}\right) + \\
+  \dfrac{2a_{ux} \pi u_x \Rho_1 U_1}{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)+ \\
+\dfrac{4a_{ux}^2 \pi^2 u_x \mu }{3L^2}\sin\left(\dfrac{a_{ux} \pi x}{L}\right). 
\f]



\subsection 1D_Total Energy


The last component of Navier--Stokes equations is written as an operator:
\f[
 \Lo=\Diff{\rho ue_t}{x}+ \Diff{pu}{x}+ \Diff{q_x}{x}-\Diff{u\tau_{xx}}{x} .
\f]

Source term \f$Q_{e_t}\f$ is obtained by operating \f$\Lo\f$ on Equation  for energy:
  \f[
Q_{e_t} = \dfrac{a_{\rho x} \pi \rho_x U_1^3 }{2L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
- \dfrac{\gamma}{\gamma-1}\dfrac{a_{px} \pi p_x U_1}{L}\sin\left(\dfrac{a_{px} \pi x}{L}\right) +\\
+ \dfrac{\gamma}{\gamma-1}\dfrac{a_{ux} \pi u_x \PP_1}{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)  +\\
+ \dfrac{ 3 a_{ux} \pi u_x \Rho_1 U_1^2 }{2L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\\
-\dfrac{2 a_{\rho x}^2 \pi^2 \rho_x^2 k \PP_1}{L^2 R \Rho_1^3}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)^2 +\\
-\dfrac{2 a_{\rho x} a_{px} \pi^2 \rho_x p_x k }{L^2 R \Rho_1^2}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{px} \pi x}{L}\right) +\\
-\dfrac{a_{\rho x}^2 \pi^2 \rho_x k \PP_1 }{L^2 R \Rho_1^2}\sin\left(\dfrac{a_{\rho x} \pi x}{L}\right) +\\
+\dfrac{a_{px}^2 \pi^2 p_x k }{L^2 R \Rho_1}\cos\left(\dfrac{a_{px} \pi x}{L}\right) +\\
-\dfrac{4a_{ux}^2 \pi^2 u_x^2 \mu }{3L^2}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)^2 +\\
+\dfrac{4a_{ux}^2 \pi^2 u_x \mu U_1 }{3L^2}\sin\left(\dfrac{a_{ux} \pi x}{L}\right).
 
\f]

 \section 2D_Steady Navier--Stokes equations
The manufactured analytical solutions for each one of the variables in two-dimensional case of 
Navier\--Stokes equations are:
\f[

\rho\left(x,y\right) =  \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho y} \pi y}{L}\right),\\
u\left(x,y\right) = u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u y} \pi y}{L}\right),\\
v\left(x,y\right) = v_{0}+v_{x} \cos\left(\frac{a_{v x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v y} \pi y}{L}\right),\\
p\left(x,y\right) = p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p y} \pi y}{L}\right).\\

\f]

Analogously to the 1D case, MMS applied to the 2D steady Navier--Stokes consists in modifying Equations by adding a source term to the right-hand side of each equation:
\f[


 \Diff{\rho u}{x}+\Diff{\rho v}{y} = Q_\rho\\
 \Diff{\rho u^2 }{x}+\Diff{\rho uv}{y} +\Diff{p}{x}-\Diff{\tau_{xx}}{x}-\Diff{\tau_{xy}}{y}= Q_u\\
 \Diff{\rho uv}{x}+\Diff{\rho v^2}{y} +\Diff{p}{y}-\Diff{\tau_{yx}}{x}-\Diff{\tau_{yy}}{y}= Q_v\\
 \Diff{\rho ue_t }{x}+\Diff{\rho ve_t}{y}+\Diff{pu}{x} +\Diff{pv}{y}+\Diff{q_x}{x}+\Diff{q_y}{y}-\Diff{u\tau_{xx}+v\tau_{xy}}{x}-\Diff{u\tau_{yx}+v\tau_{yy}}{y}= Q_{e_t}

\f]
so the modified set of Equations () as analytical solution.

Source terms \f$Q_\rho\f$, \f$Q_u\f$, \f$Q_v\f$ and \f$Q_{e_t}\f$ are presented in the subsequent sessions with the use of the auxiliary variables:
\f[
 

\Rho_2 = \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho y} \pi y}{L}\right),\\
U_2 = u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u y} \pi y}{L}\right),\\
\V_2 = v_{0}+v_{x} \cos\left(\frac{a_{v x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v y} \pi y}{L}\right),\\
\PP_2 = p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p y} \pi y}{L}\right),\\

\f]

where the subscripts in \f$\Rho_2\f$, \f$\PP_2\f$, \f$U_2\f$ and \f$\V_2\f$ refer to the 2D case.

\subsection 2D-Mass Conservation

The 2D mass conservation equation written as an operator is:
\f[
 \Lo=  \Diff{\rho u}{x}+\Diff{\rho v}{y}.
\f]

Analytically differentiating Equation:
\f[
 
Q_\rho = \dfrac{a_{\rho x} \pi \rho_x U_2 }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
-\dfrac{a_{\rho y} \pi \rho_y \V_2 }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
+\dfrac{\pi \Rho_2}{L}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} 
\pi}{L}\right)\right].
 
\f]

\subsection 2D-Momentum

For the generation of the analytical source term \f$Q_u\f$ for the \f$x\f$-momentum equation, the first component of equation is written as an  operator \f$\Lo\f$:
\f[
 \Lo= \Diff{\rho u^2 }{x}+\Diff{\rho uv}{y} +\Diff{p}{x}-\Diff{\tau_{xx}}{x}-\Diff{\tau_{xy}}{y},
\f]
which, when operated in Equation:

\f[
 
Q_u =  \dfrac{a_{\rho x} \pi \rho_x U_2^2}{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
- \dfrac{a_{\rho y} \pi \rho_y U_2 \V_2}{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
-\dfrac{a_{px} \pi p_x }{L}\sin\left(\dfrac{a_{px} \pi x}{L}\right)+\\
+\dfrac{\pi \Rho_2 U_2}{L}\left[2 a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+\\
-\dfrac{a_{uy} \pi u_y \Rho_2 \V_2 }{L}\sin\left(\dfrac{a_{uy} \pi y}{L}\right)+\\
+\dfrac{4a_{ux}^2 \pi^2 u_x \mu}{3L^2}\sin\left(\dfrac{a_{ux} \pi x}{L}\right) +\\
+\dfrac{a_{uy}^2 \pi^2 u_y \mu}{L^2}\cos\left(\dfrac{a_{uy} \pi y}{L}\right).
 
\f]


Analogously, for the generation of the analytical source term \f$Q_v\f$ for the \f$y\f$-momentum equation, the second component of Equation is written as an  operator \f$\Lo\f$:
\f[
   \Lo =\Diff{\rho uv}{x}+\Diff{\rho v^2}{y} +\Diff{p}{y}-\Diff{\tau_{yx}}{x}-\Diff{\tau_{yy}}{y},
\f]
and then applied to Equation. It yields:
\f[
 
Q_v =\dfrac{ a_{\rho x} \pi \rho_x U_2 \V_2 }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
-\dfrac{a_{\rho y} \pi \rho_y \V_2^2 }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
+\dfrac{a_{py} \pi p_y}{L}\cos\left(\dfrac{a_{py} \pi y}{L}\right) +\\
-\dfrac{ a_{vx} \pi v_x \Rho_2 U_2}{L}\sin\left(\dfrac{a_{vx} \pi x}{L}\right)+\\
+\dfrac{\pi \Rho_2 \V_2}{L}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+2 v_y a_{vy} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+\\
+\dfrac{a_{vx}^2 \pi^2 v_x \mu }{L^2}\cos\left(\dfrac{a_{vx} \pi x}{L}\right) +\\
+\dfrac{4a_{vy}^2 \pi^2 v_y \mu }{3L^2}\sin\left(\dfrac{a_{vy} \pi y}{L}\right)

 
\f]



\subsection 2D-Total Energy

The operator for the 2D Navier--Stokes total energy is:
\f[
 \Lo=  \Diff{\rho ue_t }{x}+\Diff{\rho ve_t}{y}+\Diff{pu}{x} +\Diff{pv}{y}+\Diff{q_x}{x}+\Diff{q_y}{y}-\Diff{u\tau_{xx}+v\tau_{xy}}{x}-\Diff{u\tau_{yx}+v\tau_{yy}}{y}.
\f]


Source term \f$Q_{e_t}\f$ is obtained by operating \f$\Lo\f$ on Equation for energy:

\f[
 
Q_{e_t} =\dfrac{ a_{\rho x} \pi \rho_x  U_2 (U_2^2+\V_2^2)}{2L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
-\dfrac{ a_{\rho y} \pi \rho_y \V_2 (U_2^2+\V_2^2) }{2L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) +\\
-\dfrac{\gamma}{\gamma-1}\dfrac{a_{px} \pi p_x  U_2}{L}\sin\left(\dfrac{a_{px} \pi x}{L}\right) +\\
+  \dfrac{\gamma}{\gamma-1}\dfrac{a_{py}\pi p_y  \V_2}{L}\cos\left(\dfrac{a_{py} \pi y}{L}\right)+\\
+ \dfrac{ \pi \Rho_2 U_2^2}{2L}\left[3 a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+\\
-\dfrac{\pi \Rho_2 U_2 \V_2}{L}\left[a_{uy} u_y \sin\left(\dfrac{a_{uy} \pi y}{L}\right)+a_{vx}  v_x\sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right] +\\
+\dfrac{\pi \Rho_2 \V_2^2}{2L} \left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+3 a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
+ \dfrac{\gamma}{\gamma-1}\dfrac{\pi \PP_2}{L}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+\\
+\dfrac{ \pi^2 k}{L^2 R \Rho_2}\left[a_{px}^2 p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+a_{py}^2 p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)\right] +\\
-\dfrac{\pi^2 k \PP_2}{L^2 R \Rho_2^2}\left[a_{\rho x}^2 \rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+a_{\rho y}^2 \rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)\right] +\\
-\dfrac{ 2 \pi^2 k }{L^2 R \Rho_2^2}\left[a_{\rho x} a_{px} \rho_x p_x \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{px} \pi x}{L}\right)+a_{\rho y} a_{py} \rho_y p_y \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \cos\left(\dfrac{a_{py} \pi y}{L}\right)\right]+\\
- \dfrac{2\pi^2 k \PP_2 }{L^2 R \Rho_2^3}\left[a_{\rho x}^2 \rho_x^2 \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)^2+a_{\rho y}^2 \rho_y^2 \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)^2\right] +\\
+\dfrac{\pi^2 \mu U_2 }{3L^2} \left[4 a_{ux}^2 u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+3a_{uy}^2 u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right) \right] +\\
+\dfrac{\pi^2 \mu \V_2 }{3L^2} \left[3 a_{vx}^2 v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+4a_{vy}^2 v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right) \right] +\\
- \dfrac{\pi^2 \mu }{3L^2}\left[4 a_{ux}^2 u_x^2 \cos\left(\dfrac{a_{ux} \pi x}{L}\right)^2+3 a_{uy}^2 u_y^2 \sin\left(\dfrac{a_{uy} \pi y}{L}\right)^2-4 v_y a_{ux} a_{vy} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right.+\\
    \qquad\left.+6 v_x a_{uy} a_{vx} u_y \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \sin\left(\dfrac{a_{vx} \pi x}{L}\right)+3 v_x^2 a_{vx}^2 \sin\left(\dfrac{a_{vx} \pi x}{L}\right)^2+4 v_y^2 a_{vy}^2 \cos\left(\dfrac{a_{vy} \pi y}{L}\right)^2\right].
 
\f]



\section 3D-Steady Navier--Stokes equations

The manufactured analytical solution for for each one of the variables in the 3D steady Navier--Stokes equations are:
\f[


\rho\left( x ,y ,z\right) =  \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho  x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho  y} \pi y}{L}\right) + \rho_{z} \sin\left(\frac{a_{ \rho  z} \pi z}{L}\right) ,\\
u\left( x ,y ,z\right) = u_{0}+u_{x} \sin\left(\frac{a_{u  x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u  y} \pi y}{L}\right)+u_{z} \cos\left(\frac{a_{u  z} \pi z}{L}\right) ,\\
v\left( x ,y ,z\right) = v_{0}+v_{x} \cos\left(\frac{a_{v  x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v  y} \pi y}{L}\right)+v_{z} \sin\left(\frac{a_{v  z} \pi z}{L}\right), \\
w\left( x ,y ,z\right) = w_{0}+w_{x} \sin\left(\frac{a_{w  x} \pi x}{L}\right)+w_{y} \sin\left(\frac{a_{w  y} \pi y}{L}\right)+ w_{z} \cos\left(\frac{a_{w  z} \pi z}{L}\right) ,\\
p\left( x ,y ,z\right) = p_{0}+p_{x} \cos\left(\frac{a_{p  x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p  y} \pi y}{L}\right)+ p_{z} \cos\left(\frac{a_{p  z} \pi z}{L}\right).\\

\f]

The MMS applied to 3D Navier--Stokes equations consists in modifying Equations by adding a 
source term to the right-hand side of each equation:
\f[


\Diff{\rho u}{x}+\Diff{\rho v}{y} + \Diff{\rho w}{z} = Q_\rho\\
 \Diff{\rho u^2 }{x}+\Diff{\rho uv}{y} +\Diff{\rho uw}{z} +\Diff{p}{x}-\Diff{\tau_{xx}}{x}-\Diff{\tau_{xy}}{y}-\Diff{\tau_{xz}}{z}= Q_u,\\
\Diff{\rho uv }{x}+\Diff{\rho v^2}{y} +\Diff{\rho vw}{z}+\Diff{p}{y}-\Diff{\tau_{yx}}{x}-\Diff{\tau_{yy}}{y}-\Diff{\tau_{yz}}{z}= Q_v,\\
\Diff{\rho uw }{ x}+\Diff{\rho  vw }{ y}+\Diff{\rho w^2 }{ z}+\Diff{p}{z}-\Diff{\tau_{zx}}{x}-\Diff{\tau_{zy}}{y}-\Diff{\tau_{zz}}{z}=Q_w,\\
\Diff{\rho u e_t}{x}+\Diff{\rho v e_t}{y}+\Diff{\rho we_t}{z}+\Diff{pu}{x}+\Diff{pv}{y}+\Diff{pw}{z} +\Diff{q_x}{x} +\Diff{q_y}{y} +\Diff{q_z}{z}+\\
    \qquad-\Diff{u\tau_{xx}+v\tau_{xy}+w\tau_{xz}}{x}-\Diff{u\tau_{yx}+v\tau_{yy}+w\tau_{yz}}{y}-\Diff{u\tau_{zx}+v\tau_{zy}+w\tau_{zz}}{y}=Q_{e_t},

\f]
so this modified set of equations has for analytical solution Equation.


Analogously to the 1D and 2D cases, the source terms \f$Q_\rho\f$, \f$Q_u\f$, \f$Q_v\f$, \f$Q_w\f$ and \f$Q_{e_t}\f$ are  presented with the use of the following auxiliary variables:
\f[
 

\Rho_3 = \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho  x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho  y} \pi y}{L}\right) + \rho_{z} \sin\left(\frac{a_{ \rho  z} \pi z}{L}\right),\\
U_3 =u_{0}+u_{x} \sin\left(\frac{a_{u  x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u  y} \pi y}{L}\right)+u_{z} \cos\left(\frac{a_{u  z} \pi z}{L}\right) ,\\
\V_3 = v_{0}+v_{x} \cos\left(\frac{a_{v  x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v  y} \pi y}{L}\right)+v_{z} \sin\left(\frac{a_{v  z} \pi z}{L}\right), \\
\W_3 = w_{0}+w_{x} \sin\left(\frac{a_{w  x} \pi x}{L}\right)+w_{y} \sin\left(\frac{a_{w  y} \pi y}{L}\right)+ w_{z} \cos\left(\frac{a_{w  z} \pi z}{L}\right) ,\\
\PP_3 = p_{0}+p_{x} \cos\left(\frac{a_{p  x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p  y} \pi y}{L}\right)+ p_{z} \cos\left(\frac{a_{p  z} \pi z}{L}\right).\\

\f]
where, again, the subscripts in \f$\Rho_3\f$, \f$\PP_3\f$, \f$U_3\f$, \f$\V_3\f$ and \f$\W_3\f$ refer to the 3D case.


\subsection 3D-Mass Conservation

The source term \f$Q_{\rho}\f$ for the 3D mass conservation equation is:
\f[
 
Q_\rho =\dfrac{ a_{\rho x} \pi \rho_x U_3}{L} \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
-\dfrac{a_{\rho y} \pi \rho_y \V_3 }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
+\dfrac{a_{\rho z} \pi \rho_z \W_3 }{L}\cos\left(\dfrac{a_{\rho z}\pi z }{L}\right)+\\
+\dfrac{\pi \Rho_3}{L}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)-a_{wz} w_z \sin\left(\dfrac{a_{wz}\pi z }{L}\right)\right].
 
\f]

\subsection 3D-Momentum

The source terms \f$Q_{u}\f$, \f$Q_{v}\f$ and \f$Q_{w}\f$ for the 3D momentum equations the in \f$x\f$, \f$y\f$ and \f$z\f$ directions are, respectively:
%
\f[
 
Q_u = \dfrac{a_{\rho x} \pi \rho_x U_3^2 }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
-\dfrac{a_{\rho y} \pi \rho_y U_3 \V_3 }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
+\dfrac{a_{\rho z} \pi \rho_z U_3 \W_3 }{L}\cos\left(\dfrac{a_{\rho z}\pi z }{L}\right)+\\
-\dfrac{a_{px} \pi p_x }{L}\sin\left(\dfrac{a_{px} \pi x}{L}\right)+\\
+\dfrac{\pi \Rho_3 U_3}{L}\left[2 a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)-a_{wz} w_z \sin\left(\dfrac{a_{wz}\pi z }{L}\right)\right]+\\
-\dfrac{a_{uy} \pi u_y \Rho_3 \V_3}{L} \sin\left(\dfrac{a_{uy} \pi y}{L}\right)+\\
-\dfrac{a_{uz} \pi u_z \Rho_3 \W_3 }{L}\sin\left(\dfrac{a_{uz}\pi z }{L}\right)+\\
+ \dfrac{4 a_{ux}^2 \pi^2  u_x \mu}{3L^2}\sin\left(\dfrac{ a_{ux}\pi x}{L}\right) +\\
+ \dfrac{a_{uy}^2 \pi^2 u_y \mu}{L^2}\cos\left(\dfrac{a_{uy} \pi y}{L}\right) +\\
+ \dfrac{a_{uz}^2 \pi^2 u_z \mu}{L^2}\cos\left(\dfrac{a_{uz} \pi z}{L}\right)
,
 
\f]

\f[
 
Q_v = \dfrac{a_{\rho x} \pi \rho_x U_3 \V_3 }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
-\dfrac{a_{\rho y} \pi \rho_y \V_3^2 }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
+\dfrac{a_{\rho z} \pi \rho_z \V_3 \W_3 }{L}\cos\left(\dfrac{a_{\rho z}\pi z }{L}\right)+\\
+\dfrac{a_{py} \pi p_y }{L}\cos\left(\dfrac{a_{py} \pi y}{L}\right)+\\
-\dfrac{a_{vx} \pi v_x \Rho_3 U_3 }{L}\sin\left(\dfrac{a_{vx} \pi x}{L}\right)+\\
+\dfrac{\pi \Rho_3 \V_3}{L}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+2 a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)-a_{wz} w_z \sin\left(\dfrac{a_{wz}\pi z }{L}\right)\right]+\\
+\dfrac{a_{vz} \pi v_z \Rho_3 \W_3 }{L}\cos\left(\dfrac{a_{vz}\pi z }{L}\right)+\\
+\dfrac{a_{vx}^2 \pi^2 v_x \mu }{L^2}\cos\left(\dfrac{a_{vx} \pi x}{L}\right) +\\
+\dfrac{4a_{vy}^2 \pi^2 v_y \mu  }{3L^2}\sin\left(\dfrac{a_{vy} \pi y}{L}\right) +\\
+\dfrac{a_{vz}^2 \pi^2 v_z \mu }{L^2}\sin\left(\dfrac{a_{vz} \pi z}{L}\right) ,
 
\f]
and


*/ 
